<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>District 113 Training Activity Report | February 2026</title>
<link href="https://fonts.googleapis.com/css2?family=Source+Serif+4:wght@400;600;700&family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{
--cg-blue:#003366;--cg-blue-light:#0055a4;--cg-gold:#c5960c;--cg-gold-light:#dab44e;
--bg:#f0f2f5;--card:#ffffff;--text:#1a1e2e;--text-muted:#5a6070;
--green:#1a8a4a;--green-bg:#e8f5ef;--amber:#b87a00;--amber-bg:#fff7e6;--red:#c0392b;--red-bg:#fce8e6;
--blue-bg:#e8f0fe;--radius:10px;
}
body{font-family:'DM Sans',sans-serif;background:var(--bg);color:var(--text);line-height:1.6;-webkit-font-smoothing:antialiased}
h1,h2,h3{font-family:'Source Serif 4',Georgia,serif}

/* HEADER */
.header{background:linear-gradient(135deg,var(--cg-blue) 0%,#001a33 100%);color:#fff;padding:40px 0 36px;position:relative;overflow:hidden}
.header::after{content:'';position:absolute;top:0;right:0;width:300px;height:100%;background:linear-gradient(135deg,transparent 40%,rgba(197,150,12,0.08) 100%)}
.header-inner{max-width:1200px;margin:0 auto;padding:0 32px;position:relative;z-index:1}
.header-badge{display:inline-flex;align-items:center;gap:8px;background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.15);border-radius:20px;padding:6px 16px;font-size:12px;letter-spacing:1px;text-transform:uppercase;margin-bottom:16px;backdrop-filter:blur(4px)}
.header-badge .dot{width:8px;height:8px;border-radius:50%;background:var(--cg-gold);animation:pulse 2s infinite}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}
.header h1{font-size:32px;font-weight:700;letter-spacing:-0.5px;margin-bottom:6px}
.header-sub{font-size:15px;opacity:0.7;font-weight:400}
.header-meta{display:flex;gap:28px;margin-top:18px;font-size:13px;opacity:0.6}
.header-meta span{display:flex;align-items:center;gap:6px}

/* METRICS */
.metrics{max-width:1200px;margin:-28px auto 28px;padding:0 32px;display:grid;grid-template-columns:repeat(5,1fr);gap:16px;position:relative;z-index:2}
.metric-card{background:var(--card);border-radius:var(--radius);padding:20px 22px;box-shadow:0 1px 3px rgba(0,0,0,0.06),0 6px 16px rgba(0,0,0,0.04);border:1px solid rgba(0,0,0,0.04);transition:transform .15s}
.metric-card:hover{transform:translateY(-2px)}
.metric-label{font-size:11px;text-transform:uppercase;letter-spacing:0.8px;color:var(--text-muted);margin-bottom:6px;font-weight:600}
.metric-value{font-family:'Source Serif 4',serif;font-size:36px;font-weight:700;color:var(--cg-blue);line-height:1.1}
.metric-detail{font-size:12px;color:var(--text-muted);margin-top:4px}
.metric-card.gold .metric-value{color:var(--cg-gold)}
.metric-card.green .metric-value{color:var(--green)}

/* CONTENT */
.content{max-width:1200px;margin:0 auto;padding:0 32px 60px}
.section{margin-bottom:28px}
.section-title{font-size:20px;font-weight:700;color:var(--cg-blue);margin-bottom:16px;display:flex;align-items:center;gap:10px}
.section-title .icon{width:28px;height:28px;background:var(--blue-bg);border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:14px}

/* EXECUTIVE SUMMARY */
.exec-summary{background:var(--card);border-radius:var(--radius);padding:28px 32px;box-shadow:0 1px 3px rgba(0,0,0,0.04);border:1px solid rgba(0,0,0,0.04);margin-bottom:28px}
.exec-summary p{color:var(--text);font-size:15px;line-height:1.8;margin-bottom:12px}
.exec-summary p:last-child{margin-bottom:0}
.highlight{background:linear-gradient(to bottom,transparent 60%,rgba(197,150,12,0.15) 60%);font-weight:600}

/* GRID */
.grid-2{display:grid;grid-template-columns:1fr 1fr;gap:20px}

/* CHART CARDS */
.chart-card{background:var(--card);border-radius:var(--radius);padding:24px;box-shadow:0 1px 3px rgba(0,0,0,0.04);border:1px solid rgba(0,0,0,0.04)}
.chart-card h3{font-size:15px;font-weight:600;margin-bottom:16px;color:var(--text)}
.bar-chart{display:flex;flex-direction:column;gap:8px}
.bar-row{display:flex;align-items:center;gap:10px}
.bar-label{width:100px;font-size:12px;color:var(--text-muted);text-align:right;flex-shrink:0;font-weight:500}
.bar-track{flex:1;height:28px;background:var(--bg);border-radius:6px;overflow:hidden;position:relative}
.bar-fill{height:100%;border-radius:6px;display:flex;align-items:center;justify-content:flex-end;padding-right:8px;font-size:11px;font-weight:700;color:#fff;transition:width .6s ease;min-width:24px}
.bar-fill.blue{background:linear-gradient(90deg,var(--cg-blue-light),var(--cg-blue))}
.bar-fill.gold{background:linear-gradient(90deg,var(--cg-gold-light),var(--cg-gold))}
.bar-fill.green{background:linear-gradient(90deg,#27ae60,var(--green))}
.bar-fill.red{background:linear-gradient(90deg,#e74c3c,var(--red))}

/* TABLES */
.table-wrap{overflow-x:auto}
table{width:100%;border-collapse:collapse;font-size:13px}
th{text-align:left;padding:10px 14px;background:var(--cg-blue);color:#fff;font-weight:600;font-size:11px;text-transform:uppercase;letter-spacing:0.6px;position:sticky;top:0}
th:first-child{border-radius:8px 0 0 0}
th:last-child{border-radius:0 8px 0 0}
td{padding:10px 14px;border-bottom:1px solid #f0f0f0}
tr:hover td{background:#f8f9fb}
.badge{display:inline-block;padding:2px 10px;border-radius:12px;font-size:11px;font-weight:600}
.badge-green{background:var(--green-bg);color:var(--green)}
.badge-gold{background:var(--amber-bg);color:var(--amber)}
.badge-blue{background:var(--blue-bg);color:var(--cg-blue-light)}

/* STAR PERFORMERS */
.performer{display:flex;align-items:center;gap:14px;padding:14px 0;border-bottom:1px solid #f0f0f0}
.performer:last-child{border-bottom:none}
.performer-rank{width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:14px;flex-shrink:0}
.rank-1{background:linear-gradient(135deg,#ffd700,#daa520);color:#fff}
.rank-2{background:linear-gradient(135deg,#c0c0c0,#a0a0a0);color:#fff}
.rank-3{background:linear-gradient(135deg,#cd7f32,#a0622e);color:#fff}
.rank-other{background:var(--bg);color:var(--text-muted)}
.performer-info{flex:1}
.performer-name{font-weight:600;font-size:14px}
.performer-unit{font-size:12px;color:var(--text-muted)}
.performer-count{font-family:'Source Serif 4',serif;font-size:24px;font-weight:700;color:var(--cg-blue)}

/* COURSE TYPE TAGS */
.course-tag{display:inline-block;padding:3px 10px;border-radius:5px;font-size:11px;font-weight:600;margin:2px 3px 2px 0}
.tag-core{background:#e8f0fe;color:#1a56db}
.tag-bqc{background:#e8f5ef;color:#1a8a4a}
.tag-advanced{background:#fef3e2;color:#b87a00}
.tag-safety{background:#fce8e6;color:#c0392b}

/* FILTER */
.filter-bar{display:flex;gap:10px;margin-bottom:20px;flex-wrap:wrap;align-items:center}
.filter-bar select{padding:8px 14px;border:1px solid #ddd;border-radius:8px;font-size:13px;font-family:'DM Sans',sans-serif;background:var(--card);cursor:pointer;color:var(--text)}
.filter-bar select:focus{outline:none;border-color:var(--cg-blue-light)}
.filter-label{font-size:12px;font-weight:600;color:var(--text-muted);text-transform:uppercase;letter-spacing:0.6px}

/* TABS */
.tabs{display:flex;gap:4px;background:var(--bg);border-radius:10px;padding:4px;margin-bottom:24px;width:fit-content}
.tab{padding:8px 20px;border-radius:8px;font-size:13px;font-weight:600;cursor:pointer;color:var(--text-muted);transition:all .2s;border:none;background:none;font-family:'DM Sans',sans-serif}
.tab.active{background:var(--card);color:var(--cg-blue);box-shadow:0 1px 3px rgba(0,0,0,0.08)}

/* FOOTER */
.footer{text-align:center;padding:32px;font-size:12px;color:var(--text-muted);border-top:1px solid #e0e0e0;max-width:1200px;margin:0 auto}

/* PRINT */
@media print{.header{-webkit-print-color-adjust:exact;print-color-adjust:exact}}
@media(max-width:900px){.metrics{grid-template-columns:repeat(3,1fr)}.grid-2{grid-template-columns:1fr}}
@media(max-width:600px){.metrics{grid-template-columns:repeat(2,1fr)}}
</style>
</head>
<body>

<div class="header">
<div class="header-inner">
<div class="header-badge"><span class="dot"></span> District Training Report</div>
<h1>District 113 Training Activity</h1>
<div class="header-sub">Unified Training Completions Report ‚Äî February 1‚Äì16, 2026</div>
<div class="header-meta">
<span>üìä Source: AUXDATA II / Moodle & NTC</span>
<span>üìÖ Reporting Period: Feb 1‚Äì16, 2026</span>
<span>üèõÔ∏è Prepared for COMO Losi</span>
</div>
</div>
</div>

<div class="metrics" id="metrics"></div>

<div class="content">

<div class="exec-summary" id="exec-summary"></div>

<div class="tabs">
<button class="tab active" onclick="showTab('overview')">Overview</button>
<button class="tab" onclick="showTab('divisions')">By Division</button>
<button class="tab" onclick="showTab('courses')">By Course</button>
<button class="tab" onclick="showTab('members')">All Activity</button>
</div>

<div id="tab-overview" class="tab-content">
<div class="grid-2">
<div class="chart-card">
<h3>Completions by Division</h3>
<div id="div-chart" class="bar-chart"></div>
</div>
<div class="chart-card">
<h3>Top Performers ‚Äî Most Completions</h3>
<div id="top-performers"></div>
</div>
</div>
<div style="height:20px"></div>
<div class="grid-2">
<div class="chart-card">
<h3>Course Category Breakdown</h3>
<div id="category-chart" class="bar-chart"></div>
</div>
<div class="chart-card">
<h3>BQC II Progress ‚Äî New Members</h3>
<div id="bqc-progress"></div>
</div>
</div>
</div>

<div id="tab-divisions" class="tab-content" style="display:none">
<div class="chart-card">
<div class="filter-bar">
<span class="filter-label">Division:</span>
<select id="div-filter" onchange="renderDivisionDetail()">
<option value="all">All Divisions</option>
</select>
</div>
<div class="table-wrap">
<table id="div-table">
<thead><tr><th>Division</th><th>Units</th><th>Members Active</th><th>Completions</th><th>Top Course</th></tr></thead>
<tbody></tbody>
</table>
</div>
</div>
</div>

<div id="tab-courses" class="tab-content" style="display:none">
<div class="chart-card">
<div class="filter-bar">
<span class="filter-label">Category:</span>
<select id="course-cat-filter" onchange="renderCourseDetail()">
<option value="all">All Categories</option>
<option value="core">Core Training (AUXCT)</option>
<option value="bqc">BQC II Modules</option>
<option value="advanced">Advanced / Specialty</option>
<option value="safety">Safety & Compliance</option>
</select>
</div>
<div class="table-wrap">
<table id="course-table">
<thead><tr><th>Course</th><th>Full Name</th><th>Category</th><th>Completions</th><th>Units Represented</th></tr></thead>
<tbody></tbody>
</table>
</div>
</div>
</div>

<div id="tab-members" class="tab-content" style="display:none">
<div class="chart-card">
<div class="filter-bar">
<span class="filter-label">Unit:</span>
<select id="member-unit-filter" onchange="renderMemberTable()"><option value="all">All Units</option></select>
<span class="filter-label" style="margin-left:10px">Course:</span>
<select id="member-course-filter" onchange="renderMemberTable()"><option value="all">All Courses</option></select>
</div>
<div class="table-wrap">
<table id="member-table">
<thead><tr><th>Name</th><th>Member ID</th><th>Unit</th><th>Course</th><th>Completed</th><th>System</th></tr></thead>
<tbody></tbody>
</table>
</div>
</div>
</div>

</div>

<div class="footer">
District 113 Unified Training Report ‚Äî Generated by D-AD-TMA Training Management<br>
Commodore's Aide - Training Management Assistant | Yohannes Tilahun
</div>

<script>
const DATA = [{"unit": "1130102", "last": "TOM", "first": "LEONARD", "member_id": "5007086", "completion_date": "04-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BBP 2026", "course_short": "AUX-BBP"}, {"unit": "1130104", "last": "PAZ", "first": "CAROL", "member_id": "1162951", "completion_date": "03-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BBP 2026", "course_short": "AUX-BBP"}, {"unit": "1130104", "last": "SLOAN", "first": "JASON", "member_id": "1224382", "completion_date": "06-Feb-2026", "training_system": "Moodle", "course_long": "PAWAR 810015", "course_short": "PAWAR"}, {"unit": "1130104", "last": "SLOAN", "first": "JASON", "member_id": "1224382", "completion_date": "06-Feb-2026", "training_system": "Moodle", "course_long": "SETA 810030", "course_short": "SETA"}, {"unit": "1130104", "last": "SLOAN", "first": "JASON", "member_id": "1224382", "completion_date": "06-Feb-2026", "training_system": "Moodle", "course_long": "WR 502379", "course_short": "SP"}, {"unit": "1130104", "last": "SLOAN", "first": "JASON", "member_id": "1224382", "completion_date": "06-Feb-2026", "training_system": "Moodle", "course_long": "CRA 502319", "course_short": "CRA"}, {"unit": "1130104", "last": "SLOAN", "first": "JASON", "member_id": "1224382", "completion_date": "06-Feb-2026", "training_system": "Moodle", "course_long": "POSH 810000", "course_short": "POSH"}, {"unit": "1130301", "last": "BARNETT", "first": "JANET", "member_id": "1215093", "completion_date": "07-Feb-2026", "training_system": "Moodle", "course_long": "7278", "course_short": "Suicide Prevention (100643)"}, {"unit": "1130301", "last": "HYPOLITE", "first": "CARMEN", "member_id": "5010127", "completion_date": "04-Feb-2026", "training_system": "Moodle", "course_long": "CRA 502319", "course_short": "CRA"}, {"unit": "1130301", "last": "HYPOLITE", "first": "CARMEN", "member_id": "5010127", "completion_date": "06-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BCQC II Q7", "course_short": "BQCM7"}, {"unit": "1130301", "last": "HYPOLITE", "first": "CARMEN", "member_id": "5010127", "completion_date": "06-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BQC II Q6", "course_short": "BQCM6"}, {"unit": "1130301", "last": "HYPOLITE", "first": "CARMEN", "member_id": "5010127", "completion_date": "06-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BQC II Q5", "course_short": "BQCM5"}, {"unit": "1130301", "last": "HYPOLITE", "first": "CARMEN", "member_id": "5010127", "completion_date": "06-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BQC II Q4", "course_short": "BQCM4"}, {"unit": "1130301", "last": "HYPOLITE", "first": "CARMEN", "member_id": "5010127", "completion_date": "06-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BQC II Q3", "course_short": "BQCM3"}, {"unit": "1130301", "last": "HYPOLITE", "first": "CARMEN", "member_id": "5010127", "completion_date": "06-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BQC II Q2", "course_short": "BQCM2"}, {"unit": "1130301", "last": "HYPOLITE", "first": "CARMEN", "member_id": "5010127", "completion_date": "06-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BQC II Q1", "course_short": "BQCM1"}, {"unit": "1130301", "last": "HYPOLITE", "first": "CARMEN", "member_id": "5010127", "completion_date": "07-Feb-2026", "training_system": "Moodle", "course_long": "WR 502379", "course_short": "SP"}, {"unit": "1130301", "last": "HYPOLITE", "first": "CARMEN", "member_id": "5010127", "completion_date": "09-Feb-2026", "training_system": "Moodle", "course_long": "ET 502306", "course_short": "ET"}, {"unit": "1130301", "last": "HYPOLITE", "first": "CARMEN", "member_id": "5010127", "completion_date": "12-Feb-2026", "training_system": "Moodle", "course_long": "SETA 810030", "course_short": "SETA"}, {"unit": "1130301", "last": "MONTAGNE", "first": "RAYMOND", "member_id": "1248380", "completion_date": "07-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BBP 2026", "course_short": "AUX-BBP"}, {"unit": "1130301", "last": "OGURO", "first": "MICHAEL", "member_id": "5010010", "completion_date": "14-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BQC II Q2", "course_short": "BQCM2"}, {"unit": "1130301", "last": "OGURO", "first": "MICHAEL", "member_id": "5010010", "completion_date": "14-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BQC II Q1", "course_short": "BQCM1"}, {"unit": "1130301", "last": "SANTOS", "first": "LUIS", "member_id": "5009719", "completion_date": "04-Feb-2026", "training_system": "NTC", "course_long": "RBS VISITOR QUALIFICATION COURSE", "course_short": "MDV"}, {"unit": "1130301", "last": "TASAKOS", "first": "LEONIDAS", "member_id": "5010129", "completion_date": "02-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BBP 2026", "course_short": "AUX-BBP"}, {"unit": "1130301", "last": "WOODWARD", "first": "DELMAR", "member_id": "5010065", "completion_date": "12-Feb-2026", "training_system": "Moodle", "course_long": "CRA 502319", "course_short": "CRA"}, {"unit": "1130305", "last": "KAISER", "first": "RUSSELL", "member_id": "1247178", "completion_date": "05-Feb-2026", "training_system": "NTC", "course_long": "NAVIGATION RULES EXAM (95)", "course_short": "NRUL95"}, {"unit": "1130305", "last": "MCENDREE", "first": "HAYLEY", "member_id": "5004058", "completion_date": "08-Feb-2026", "training_system": "Moodle", "course_long": "7278", "course_short": "Suicide Prevention (100643)"}, {"unit": "1130305", "last": "RENO", "first": "STEPHEN", "member_id": "5010006", "completion_date": "02-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BBP 2026", "course_short": "AUX-BBP"}, {"unit": "1130305", "last": "RENO", "first": "STEPHEN", "member_id": "5010006", "completion_date": "04-Feb-2026", "training_system": "Moodle", "course_long": "ET 502306", "course_short": "ET"}, {"unit": "1130305", "last": "RENO", "first": "STEPHEN", "member_id": "5010006", "completion_date": "04-Feb-2026", "training_system": "Moodle", "course_long": "CRA 502319", "course_short": "CRA"}, {"unit": "1130305", "last": "RENO", "first": "STEPHEN", "member_id": "5010006", "completion_date": "04-Feb-2026", "training_system": "Moodle", "course_long": "PAWAR 810015", "course_short": "PAWAR"}, {"unit": "1130305", "last": "RENO", "first": "STEPHEN", "member_id": "5010006", "completion_date": "04-Feb-2026", "training_system": "Moodle", "course_long": "SETA 810030", "course_short": "SETA"}, {"unit": "1130305", "last": "RENO", "first": "STEPHEN", "member_id": "5010006", "completion_date": "05-Feb-2026", "training_system": "Moodle", "course_long": "7278", "course_short": "Suicide Prevention (100643)"}, {"unit": "1130305", "last": "RENO", "first": "STEPHEN", "member_id": "5010006", "completion_date": "05-Feb-2026", "training_system": "Moodle", "course_long": "POSH 810000", "course_short": "POSH"}, {"unit": "1130305", "last": "RENO", "first": "STEPHEN", "member_id": "5010006", "completion_date": "09-Feb-2026", "training_system": "Moodle", "course_long": "WR 502379", "course_short": "SP"}, {"unit": "1130305", "last": "RENO", "first": "STEPHEN", "member_id": "5010006", "completion_date": "11-Feb-2026", "training_system": "NTC", "course_long": "VESSEL EXAMINER COURSE", "course_short": "VE"}, {"unit": "1130401", "last": "ASILO", "first": "FABIAN", "member_id": "5007708", "completion_date": "07-Feb-2026", "training_system": "NTC", "course_long": "INTRODUCTION TO MARINE SAFETY AND ENVIRONMENTAL PROTECTION", "course_short": "MSEP"}, {"unit": "1130401", "last": "ASILO", "first": "FABIAN", "member_id": "5007708", "completion_date": "10-Feb-2026", "training_system": "NTC", "course_long": "GOOD MATE COURSE", "course_short": "GMATE"}, {"unit": "1130401", "last": "BERGADO", "first": "KENNETH", "member_id": "5000408", "completion_date": "02-Feb-2026", "training_system": "NTC", "course_long": "INTRODUCTION TO MARINE SAFETY AND ENVIRONMENTAL PROTECTION", "course_short": "MSEP"}, {"unit": "1130401", "last": "BERGADO", "first": "KENNETH", "member_id": "5000408", "completion_date": "04-Feb-2026", "training_system": "NTC", "course_long": "GOOD MATE COURSE", "course_short": "GMATE"}, {"unit": "1130401", "last": "BERGADO", "first": "KENNETH", "member_id": "5000408", "completion_date": "05-Feb-2026", "training_system": "Moodle", "course_long": "ICS210", "course_short": "ICS210"}, {"unit": "1130401", "last": "FLORES", "first": "JUDE", "member_id": "1234118", "completion_date": "14-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BQC II Q1", "course_short": "BQCM1"}, {"unit": "1130401", "last": "FLORES", "first": "JUDE", "member_id": "1234118", "completion_date": "15-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BCQC II Q7", "course_short": "BQCM7"}, {"unit": "1130401", "last": "FLORES", "first": "JUDE", "member_id": "1234118", "completion_date": "15-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BQC II Q6", "course_short": "BQCM6"}, {"unit": "1130401", "last": "FLORES", "first": "JUDE", "member_id": "1234118", "completion_date": "15-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BQC II Q5", "course_short": "BQCM5"}, {"unit": "1130401", "last": "FLORES", "first": "JUDE", "member_id": "1234118", "completion_date": "15-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BQC II Q4", "course_short": "BQCM4"}, {"unit": "1130401", "last": "FLORES", "first": "JUDE", "member_id": "1234118", "completion_date": "15-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BQC II Q3", "course_short": "BQCM3"}, {"unit": "1130401", "last": "FLORES", "first": "JUDE", "member_id": "1234118", "completion_date": "15-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BQC II Q2", "course_short": "BQCM2"}, {"unit": "1130401", "last": "FULCHER", "first": "SHERRY", "member_id": "1236295", "completion_date": "06-Feb-2026", "training_system": "Moodle", "course_long": "ET 502306", "course_short": "ET"}, {"unit": "1130401", "last": "FULCHER", "first": "SHERRY", "member_id": "1236295", "completion_date": "06-Feb-2026", "training_system": "Moodle", "course_long": "PAWAR 810015", "course_short": "PAWAR"}, {"unit": "1130401", "last": "FULCHER", "first": "SHERRY", "member_id": "1236295", "completion_date": "07-Feb-2026", "training_system": "Moodle", "course_long": "SETA 810030", "course_short": "SETA"}, {"unit": "1130401", "last": "FULCHER", "first": "SHERRY", "member_id": "1236295", "completion_date": "07-Feb-2026", "training_system": "Moodle", "course_long": "WR 502379", "course_short": "SP"}, {"unit": "1130401", "last": "FULCHER", "first": "SHERRY", "member_id": "1236295", "completion_date": "08-Feb-2026", "training_system": "Moodle", "course_long": "POSH 810000", "course_short": "POSH"}, {"unit": "1130401", "last": "MASANA", "first": "ROGELITO", "member_id": "5007705", "completion_date": "05-Feb-2026", "training_system": "NTC", "course_long": "FLOTILLA LEADERSHIP COURSE - ONLINE", "course_short": "FLC-O"}, {"unit": "1130401", "last": "MASANA", "first": "ROGELITO", "member_id": "5007705", "completion_date": "06-Feb-2026", "training_system": "Moodle", "course_long": "ICS210", "course_short": "ICS210"}, {"unit": "1130401", "last": "MASANA", "first": "ROGELITO", "member_id": "5007705", "completion_date": "09-Feb-2026", "training_system": "NTC", "course_long": "INTRODUCTION TO MARINE SAFETY AND ENVIRONMENTAL PROTECTION", "course_short": "MSEP"}, {"unit": "1130401", "last": "MASANA", "first": "ROGELITO", "member_id": "5007705", "completion_date": "09-Feb-2026", "training_system": "NTC", "course_long": "GOOD MATE COURSE", "course_short": "GMATE"}, {"unit": "1130401", "last": "SCHOLZ", "first": "WILLIAM", "member_id": "1145248", "completion_date": "02-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BBP 2026", "course_short": "AUX-BBP"}, {"unit": "1130406", "last": "CORBANI", "first": "MICHELLE", "member_id": "5010442", "completion_date": "02-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BQC II Q6", "course_short": "BQCM6"}, {"unit": "1130406", "last": "CORBANI", "first": "MAURO", "member_id": "5010441", "completion_date": "03-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BBP 2026", "course_short": "AUX-BBP"}, {"unit": "1130406", "last": "CORBANI", "first": "MICHELLE", "member_id": "5010442", "completion_date": "03-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BCQC II Q7", "course_short": "BQCM7"}, {"unit": "1130406", "last": "CORBANI", "first": "MAURO", "member_id": "5010441", "completion_date": "03-Feb-2026", "training_system": "Moodle", "course_long": "7278", "course_short": "Suicide Prevention (100643)"}, {"unit": "1130406", "last": "CORBANI", "first": "MAURO", "member_id": "5010441", "completion_date": "03-Feb-2026", "training_system": "Moodle", "course_long": "ET 502306", "course_short": "ET"}, {"unit": "1130406", "last": "CORBANI", "first": "MAURO", "member_id": "5010441", "completion_date": "03-Feb-2026", "training_system": "Moodle", "course_long": "CRA 502319", "course_short": "CRA"}, {"unit": "1130406", "last": "CORBANI", "first": "MAURO", "member_id": "5010441", "completion_date": "03-Feb-2026", "training_system": "Moodle", "course_long": "POSH 810000", "course_short": "POSH"}, {"unit": "1130406", "last": "CORBANI", "first": "MICHELLE", "member_id": "5010442", "completion_date": "06-Feb-2026", "training_system": "Moodle", "course_long": "7278", "course_short": "Suicide Prevention (100643)"}, {"unit": "1130406", "last": "CORBANI", "first": "MICHELLE", "member_id": "5010442", "completion_date": "06-Feb-2026", "training_system": "Moodle", "course_long": "POSH 810000", "course_short": "POSH"}, {"unit": "1130406", "last": "CORBANI", "first": "MICHELLE", "member_id": "5010442", "completion_date": "09-Feb-2026", "training_system": "Moodle", "course_long": "WR 502379", "course_short": "SP"}, {"unit": "1130406", "last": "CORBANI", "first": "MICHELLE", "member_id": "5010442", "completion_date": "10-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BBP 2026", "course_short": "AUX-BBP"}, {"unit": "1130406", "last": "CORBANI", "first": "MICHELLE", "member_id": "5010442", "completion_date": "12-Feb-2026", "training_system": "Moodle", "course_long": "PAWAR 810015", "course_short": "PAWAR"}, {"unit": "1130406", "last": "CORBANI", "first": "MICHELLE", "member_id": "5010442", "completion_date": "14-Feb-2026", "training_system": "Moodle", "course_long": "SETA 810030", "course_short": "SETA"}, {"unit": "1130406", "last": "CORBANI", "first": "MICHELLE", "member_id": "5010442", "completion_date": "14-Feb-2026", "training_system": "Moodle", "course_long": "CRA 502319", "course_short": "CRA"}, {"unit": "1130406", "last": "HICKAM", "first": "JOHN_ROBERT", "member_id": "3010164", "completion_date": "11-Feb-2026", "training_system": "NTC", "course_long": "BQC CORE VALUES & MISSIONS", "course_short": "BQCM1"}, {"unit": "1130406", "last": "TAN", "first": "RANDY", "member_id": "3002195", "completion_date": "02-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BBP 2026", "course_short": "AUX-BBP"}, {"unit": "1130406", "last": "TEEGARDEN", "first": "PORTER", "member_id": "3006136", "completion_date": "14-Feb-2026", "training_system": "Moodle", "course_long": "7278", "course_short": "Suicide Prevention (100643)"}, {"unit": "1130406", "last": "TEEGARDEN", "first": "PORTER", "member_id": "3006136", "completion_date": "15-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BQC II Q1", "course_short": "BQCM1"}, {"unit": "1130406", "last": "TEEGARDEN", "first": "PORTER", "member_id": "3006136", "completion_date": "16-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BQC II Q2", "course_short": "BQCM2"}, {"unit": "1130406", "last": "VERVENIOTIS", "first": "KRISTAN", "member_id": "3001494", "completion_date": "11-Feb-2026", "training_system": "Moodle", "course_long": "APC", "course_short": "APC"}, {"unit": "1130501", "last": "PORTERFIELD", "first": "HEATHER", "member_id": "1176937", "completion_date": "12-Feb-2026", "training_system": "NTC", "course_long": "FINGERPRINT TECHNICIAN EXAM", "course_short": "FPRINTTECH"}, {"unit": "1130503", "last": "COPE", "first": "AUGUSTINE", "member_id": "5010128", "completion_date": "03-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BQC II Q2", "course_short": "BQCM2"}, {"unit": "1130503", "last": "COPE", "first": "AUGUSTINE", "member_id": "5010128", "completion_date": "03-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BQC II Q6", "course_short": "BQCM6"}, {"unit": "1130503", "last": "COPE", "first": "AUGUSTINE", "member_id": "5010128", "completion_date": "03-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BQC II Q5", "course_short": "BQCM5"}, {"unit": "1130503", "last": "COPE", "first": "AUGUSTINE", "member_id": "5010128", "completion_date": "03-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BQC II Q4", "course_short": "BQCM4"}, {"unit": "1130503", "last": "COPE", "first": "AUGUSTINE", "member_id": "5010128", "completion_date": "03-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BQC II Q3", "course_short": "BQCM3"}, {"unit": "1130503", "last": "COPE", "first": "AUGUSTINE", "member_id": "5010128", "completion_date": "05-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BCQC II Q7", "course_short": "BQCM7"}, {"unit": "1130604", "last": "BIELSKER", "first": "DEBORAH", "member_id": "1248888", "completion_date": "10-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BBP 2026", "course_short": "AUX-BBP"}, {"unit": "1130604", "last": "BIELSKER", "first": "DAVID", "member_id": "1248544", "completion_date": "10-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BBP 2026", "course_short": "AUX-BBP"}, {"unit": "1130604", "last": "MOSES", "first": "JOSEPH", "member_id": "5001312", "completion_date": "03-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BBP 2026", "course_short": "AUX-BBP"}, {"unit": "1130607", "last": "ESCARREOLA", "first": "DANIEL", "member_id": "3005186", "completion_date": "13-Feb-2026", "training_system": "Moodle", "course_long": "CRA 502319", "course_short": "CRA"}, {"unit": "1130610", "last": "BRAZIL", "first": "JACOB", "member_id": "5010126", "completion_date": "02-Feb-2026", "training_system": "Moodle", "course_long": "AUX-RM", "course_short": "RM-INTRO"}, {"unit": "1130610", "last": "BRAZIL", "first": "JACOB", "member_id": "5010126", "completion_date": "04-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BBP 2026", "course_short": "AUX-BBP"}, {"unit": "1130610", "last": "BRAZIL", "first": "JACOB", "member_id": "5010126", "completion_date": "04-Feb-2026", "training_system": "Moodle", "course_long": "7278", "course_short": "Suicide Prevention (100643)"}, {"unit": "1130610", "last": "BRAZIL", "first": "JACOB", "member_id": "5010126", "completion_date": "04-Feb-2026", "training_system": "Moodle", "course_long": "POSH 810000", "course_short": "POSH"}, {"unit": "1130610", "last": "BRAZIL", "first": "JACOB", "member_id": "5010126", "completion_date": "07-Feb-2026", "training_system": "Moodle", "course_long": "SETA 810030", "course_short": "SETA"}, {"unit": "1130610", "last": "BRAZIL", "first": "JACOB", "member_id": "5010126", "completion_date": "07-Feb-2026", "training_system": "Moodle", "course_long": "ET 502306", "course_short": "ET"}, {"unit": "1130610", "last": "BRAZIL", "first": "JACOB", "member_id": "5010126", "completion_date": "07-Feb-2026", "training_system": "Moodle", "course_long": "CRA 502319", "course_short": "CRA"}, {"unit": "1130610", "last": "DAVIDS", "first": "JOHN", "member_id": "5009779", "completion_date": "14-Feb-2026", "training_system": "Moodle", "course_long": "WR 502379", "course_short": "SP"}, {"unit": "1130610", "last": "LIN", "first": "HERCULES", "member_id": "5010315", "completion_date": "02-Feb-2026", "training_system": "Moodle", "course_long": "ALCC-2", "course_short": "ALCC-2"}, {"unit": "1130610", "last": "LIN", "first": "HERCULES", "member_id": "5010315", "completion_date": "04-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BBP 2026", "course_short": "AUX-BBP"}, {"unit": "1130610", "last": "SMITH", "first": "WALLACE", "member_id": "1229427", "completion_date": "07-Feb-2026", "training_system": "Moodle", "course_long": "ITWKSP-2026", "course_short": "Instructor Workshop"}, {"unit": "1130610", "last": "STANTON", "first": "ALAN", "member_id": "3001141", "completion_date": "08-Feb-2026", "training_system": "Moodle", "course_long": "ITWKSP-2026", "course_short": "Instructor Workshop"}, {"unit": "1130702", "last": "BROWN", "first": "PAUL", "member_id": "1241467", "completion_date": "03-Feb-2026", "training_system": "Moodle", "course_long": "WR 502379", "course_short": "SP"}, {"unit": "1130702", "last": "BROWN", "first": "PAUL", "member_id": "1241467", "completion_date": "07-Feb-2026", "training_system": "Moodle", "course_long": "CRA 502319", "course_short": "CRA"}, {"unit": "1130702", "last": "CUSTANCE", "first": "PAUL", "member_id": "1232352", "completion_date": "04-Feb-2026", "training_system": "Moodle", "course_long": "VEWS", "course_short": "VEWS"}, {"unit": "1130706", "last": "ROBERTSON", "first": "RUSSELL", "member_id": "1241996", "completion_date": "10-Feb-2026", "training_system": "Moodle", "course_long": "CRA 502319", "course_short": "CRA"}, {"unit": "1130839", "last": "FLETCHER", "first": "LOWELL", "member_id": "1208936", "completion_date": "09-Feb-2026", "training_system": "Moodle", "course_long": "PAWAR 810015", "course_short": "PAWAR"}, {"unit": "1130839", "last": "RIEDE", "first": "CRISTY", "member_id": "3005260", "completion_date": "09-Feb-2026", "training_system": "Moodle", "course_long": "PAWAR 810015", "course_short": "PAWAR"}, {"unit": "1131002", "last": "KEENEY", "first": "DAVID", "member_id": "5005831", "completion_date": "15-Feb-2026", "training_system": "Moodle", "course_long": "ALCC-1", "course_short": "ALCC-1"}, {"unit": "1131005", "last": "HOFMAN", "first": "ANDRE", "member_id": "5010367", "completion_date": "12-Feb-2026", "training_system": "Moodle", "course_long": "7278", "course_short": "Suicide Prevention (100643)"}, {"unit": "1131005", "last": "HOFMAN", "first": "ANDRE", "member_id": "5010367", "completion_date": "12-Feb-2026", "training_system": "Moodle", "course_long": "ET 502306", "course_short": "ET"}, {"unit": "1131005", "last": "TORRANCE", "first": "JAMES", "member_id": "5004148", "completion_date": "03-Feb-2026", "training_system": "Moodle", "course_long": "APC", "course_short": "APC"}, {"unit": "1131101", "last": "HAGUE", "first": "RICHARD", "member_id": "5001420", "completion_date": "15-Feb-2026", "training_system": "Moodle", "course_long": "7278", "course_short": "Suicide Prevention (100643)"}, {"unit": "1131101", "last": "HAGUE", "first": "RICHARD", "member_id": "5001420", "completion_date": "15-Feb-2026", "training_system": "Moodle", "course_long": "APC", "course_short": "APC"}, {"unit": "1131101", "last": "STOLZ", "first": "WILLIAM", "member_id": "1219767", "completion_date": "02-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BBP 2026", "course_short": "AUX-BBP"}, {"unit": "1131103", "last": "MESSENGER", "first": "KENNY", "member_id": "1208340", "completion_date": "03-Feb-2026", "training_system": "Moodle", "course_long": "SETA 810030", "course_short": "SETA"}, {"unit": "1131103", "last": "MESSENGER", "first": "KENNY", "member_id": "1208340", "completion_date": "12-Feb-2026", "training_system": "Moodle", "course_long": "AUXCA SAN WKSP", "course_short": "AUXFS_SAN"}, {"unit": "1131201", "last": "SHUPE", "first": "KENNETH", "member_id": "5002577", "completion_date": "11-Feb-2026", "training_system": "Moodle", "course_long": "AUX-RM", "course_short": "RM-INTRO"}, {"unit": "1131291", "last": "ARCIERO", "first": "JESSICA", "member_id": "5009810", "completion_date": "11-Feb-2026", "training_system": "NTC", "course_long": "PILOT/OBSERVER TEST (TEST A)", "course_short": "AIR"}, {"unit": "1131291", "last": "KERR", "first": "DOUGLAS", "member_id": "1206810", "completion_date": "03-Feb-2026", "training_system": "Moodle", "course_long": "AUX-BBP 2026", "course_short": "AUX-BBP"}];

// Helpers
const divMap = {
'11301':'Division 01','11303':'Division 03','11304':'Division 04','11305':'Division 05',
'11306':'Division 06','11307':'Division 07','11308':'Division 08','11310':'Division 10',
'11311':'Division 11','11312':'Division 12'
};
function getDiv(unit){return unit.substring(0,5)}
function getDivLabel(code){return divMap[code]||('Div '+code.substring(3))}

function categorize(short){
const s=(short||'').toUpperCase();
if(['PAWAR','POSH','ET','CRA','SETA','SP'].includes(s)||s.includes('SUICIDE'))return 'core';
if(s.startsWith('BQCM'))return 'bqc';
if(['AUX-BBP','RM-INTRO'].includes(s))return 'safety';
return 'advanced';
}
const catLabels={core:'Core Training',bqc:'BQC II Modules',advanced:'Advanced / Specialty',safety:'Safety & Compliance'};
const catColors={core:'blue',bqc:'green',advanced:'gold',safety:'red'};
const catTags={core:'tag-core',bqc:'tag-bqc',advanced:'tag-advanced',safety:'tag-safety'};

// Unique sets
const units=new Set(), members=new Map(), divs=new Map(), courses=new Map();
DATA.forEach(r=>{
units.add(r.unit);
const key=r.member_id;
if(!members.has(key))members.set(key,{name:r.first+' '+r.last,unit:r.unit,count:0,courses:[]});
members.get(key).count++;
members.get(key).courses.push(r.course_short);
const d=getDiv(r.unit);
if(!divs.has(d))divs.set(d,{units:new Set(),members:new Set(),count:0,courseCounts:new Map()});
divs.get(d).units.add(r.unit);
divs.get(d).members.add(key);
divs.get(d).count++;
const cc=divs.get(d).courseCounts;
cc.set(r.course_short,(cc.get(r.course_short)||0)+1);
const cs=r.course_short;
if(!courses.has(cs))courses.set(cs,{long:r.course_long,count:0,units:new Set(),cat:categorize(cs)});
courses.get(cs).count++;
courses.get(cs).units.add(r.unit);
});

// METRICS
document.getElementById('metrics').innerHTML=`
<div class="metric-card"><div class="metric-label">Total Completions</div><div class="metric-value">${DATA.length}</div><div class="metric-detail">courses completed in period</div></div>
<div class="metric-card green"><div class="metric-label">Active Members</div><div class="metric-value">${members.size}</div><div class="metric-detail">across ${units.size} units</div></div>
<div class="metric-card"><div class="metric-label">Divisions Active</div><div class="metric-value">${divs.size}</div><div class="metric-detail">of 10 divisions reporting</div></div>
<div class="metric-card gold"><div class="metric-label">Unique Courses</div><div class="metric-value">${courses.size}</div><div class="metric-detail">different courses completed</div></div>
<div class="metric-card"><div class="metric-label">BQC Progress</div><div class="metric-value">${DATA.filter(r=>r.course_short&&r.course_short.startsWith('BQCM')).length}</div><div class="metric-detail">BQC II module completions</div></div>
`;

// EXEC SUMMARY
const topDiv=[...divs.entries()].sort((a,b)=>b[1].count-a[1].count)[0];
const bqcFull=[...members.entries()].filter(([k,v])=>v.courses.filter(c=>c&&c.startsWith('BQCM')).length>=7);
document.getElementById('exec-summary').innerHTML=`
<div class="section-title"><span class="icon">üìã</span> Executive Summary</div>
<p>In the first 16 days of February 2026, District 113 recorded <span class="highlight">${DATA.length} training completions</span> across <span class="highlight">${members.size} members</span> in <span class="highlight">${units.size} flotillas</span> spanning all 10 active divisions. The most active division was <span class="highlight">${getDivLabel(topDiv[0])}</span> with ${topDiv[1].count} completions from ${topDiv[1].members.size} members.</p>
<p>Core AUXCT training leads activity with ${DATA.filter(r=>categorize(r.course_short)==='core').length} completions, followed by safety compliance courses (${DATA.filter(r=>categorize(r.course_short)==='safety').length}). Notably, <span class="highlight">${bqcFull.length} member${bqcFull.length!==1?'s':''} completed all 7 BQC II modules</span> this period, demonstrating strong new member progression${bqcFull.length>0?': '+bqcFull.map(([k,v])=>v.name.split(' ').map(w=>w[0]+w.slice(1).toLowerCase()).join(' ')).join(', '):''}.</p>
<p>The data reflects training recorded via both Moodle (${DATA.filter(r=>r.training_system==='Moodle').length} records) and NTC (${DATA.filter(r=>r.training_system==='NTC').length} records), with transfers into AUXDATA II completed between Feb 9‚Äì16.</p>
`;

// DIVISION CHART
const divSorted=[...divs.entries()].sort((a,b)=>b[1].count-a[1].count);
const maxDiv=divSorted[0][1].count;
document.getElementById('div-chart').innerHTML=divSorted.map(([code,d])=>`
<div class="bar-row">
<div class="bar-label">${getDivLabel(code)}</div>
<div class="bar-track"><div class="bar-fill blue" style="width:${(d.count/maxDiv*100).toFixed(0)}%">${d.count}</div></div>
</div>`).join('');

// TOP PERFORMERS
const topMembers=[...members.entries()].sort((a,b)=>b[1].count-a[1].count).slice(0,6);
document.getElementById('top-performers').innerHTML=topMembers.map(([id,m],i)=>{
const name=m.name.split(' ').map(w=>w[0]+w.slice(1).toLowerCase()).join(' ');
const rankClass=i<3?'rank-'+(i+1):'rank-other';
return `<div class="performer">
<div class="performer-rank ${rankClass}">${i+1}</div>
<div class="performer-info"><div class="performer-name">${name}</div><div class="performer-unit">Unit ${m.unit} ¬∑ ${m.courses.map(c=>'<span class="course-tag '+catTags[categorize(c)]+'">'+c+'</span>').join('')}</div></div>
<div class="performer-count">${m.count}</div>
</div>`;
}).join('');

// CATEGORY CHART
const cats={};
DATA.forEach(r=>{const c=categorize(r.course_short);cats[c]=(cats[c]||0)+1});
const maxCat=Math.max(...Object.values(cats));
document.getElementById('category-chart').innerHTML=Object.entries(cats).sort((a,b)=>b[1]-a[1]).map(([cat,n])=>`
<div class="bar-row">
<div class="bar-label">${catLabels[cat]}</div>
<div class="bar-track"><div class="bar-fill ${catColors[cat]}" style="width:${(n/maxCat*100).toFixed(0)}%">${n}</div></div>
</div>`).join('');

// BQC PROGRESS
const bqcMembers=new Map();
DATA.filter(r=>r.course_short&&r.course_short.startsWith('BQCM')).forEach(r=>{
const k=r.member_id;
if(!bqcMembers.has(k))bqcMembers.set(k,{name:r.first+' '+r.last,unit:r.unit,modules:new Set()});
bqcMembers.get(k).modules.add(r.course_short);
});
document.getElementById('bqc-progress').innerHTML=[...bqcMembers.entries()].sort((a,b)=>b[1].modules.size-a[1].modules.size).map(([id,m])=>{
const name=m.name.split(' ').map(w=>w[0]+w.slice(1).toLowerCase()).join(' ');
const pct=(m.modules.size/7*100).toFixed(0);
const color=m.modules.size>=7?'green':m.modules.size>=4?'gold':'blue';
return `<div class="bar-row" style="margin-bottom:4px">
<div class="bar-label" style="width:140px" title="Unit ${m.unit}">${name}</div>
<div class="bar-track"><div class="bar-fill ${color}" style="width:${pct}%">${m.modules.size}/7</div></div>
</div>`;
}).join('')||'<p style="color:var(--text-muted);font-size:13px">No BQC II completions this period</p>';

// TABS
function showTab(id){
document.querySelectorAll('.tab-content').forEach(el=>el.style.display='none');
document.querySelectorAll('.tab').forEach(el=>el.classList.remove('active'));
document.getElementById('tab-'+id).style.display='block';
event.target.classList.add('active');
}

// DIVISION DETAIL TAB
const divFilter=document.getElementById('div-filter');
divSorted.forEach(([code])=>{
const opt=document.createElement('option');opt.value=code;opt.textContent=getDivLabel(code);
divFilter.appendChild(opt);
});
function renderDivisionDetail(){
const f=divFilter.value;
const rows=f==='all'?divSorted:divSorted.filter(([c])=>c===f);
document.querySelector('#div-table tbody').innerHTML=rows.map(([code,d])=>{
const topCourse=[...d.courseCounts.entries()].sort((a,b)=>b[1]-a[1])[0];
return `<tr>
<td><strong>${getDivLabel(code)}</strong></td>
<td>${[...d.units].sort().map(u=>'<span class="badge badge-blue">'+u+'</span>').join(' ')}</td>
<td>${d.members.size}</td>
<td><strong>${d.count}</strong></td>
<td><span class="badge badge-green">${topCourse[0]}</span> (${topCourse[1]})</td>
</tr>`;}).join('');
}
renderDivisionDetail();

// COURSE DETAIL TAB
function renderCourseDetail(){
const f=document.getElementById('course-cat-filter').value;
const rows=[...courses.entries()].filter(([k,v])=>f==='all'||v.cat===f).sort((a,b)=>b[1].count-a[1].count);
document.querySelector('#course-table tbody').innerHTML=rows.map(([short,c])=>`<tr>
<td><strong>${short}</strong></td>
<td style="font-size:12px">${c.long||''}</td>
<td><span class="course-tag ${catTags[c.cat]}">${catLabels[c.cat]}</span></td>
<td><strong>${c.count}</strong></td>
<td>${c.units.size} unit${c.units.size>1?'s':''}</td>
</tr>`).join('');
}
renderCourseDetail();

// MEMBER TABLE
const unitFilter=document.getElementById('member-unit-filter');
const courseFilter=document.getElementById('member-course-filter');
[...units].sort().forEach(u=>{const o=document.createElement('option');o.value=u;o.textContent=u;unitFilter.appendChild(o)});
[...courses.keys()].sort().forEach(c=>{const o=document.createElement('option');o.value=c;o.textContent=c;courseFilter.appendChild(o)});
function renderMemberTable(){
const uf=unitFilter.value, cf=courseFilter.value;
const rows=DATA.filter(r=>(uf==='all'||r.unit===uf)&&(cf==='all'||r.course_short===cf));
document.querySelector('#member-table tbody').innerHTML=rows.map(r=>{
const name=(r.first+' '+r.last).split(' ').map(w=>w[0]+w.slice(1).toLowerCase()).join(' ');
return `<tr>
<td><strong>${name}</strong></td>
<td>${r.member_id}</td>
<td>${r.unit}</td>
<td><span class="course-tag ${catTags[categorize(r.course_short)]}">${r.course_short}</span></td>
<td>${r.completion_date}</td>
<td><span class="badge badge-${r.training_system==='Moodle'?'gold':'blue'}">${r.training_system}</span></td>
</tr>`;}).join('');
}
renderMemberTable();
</script>

</body>
</html>
